@using PoliteCaptcha
@model ReportAbuseViewModel
@{
    ViewBag.Tab = "Packages";
    Layout = "~/Views/Shared/Gallery/Layout.cshtml";
}

<div class="container main-container page-report-abuse">
    <div class="row report-form">
        <div class="col-md-offset-1 col-md-10">
            <h1 class="page-heading text-center">Contact Support about <a href="@Url.Package(@Model.PackageId, Model.PackageVersion)">@Model.PackageId @Model.PackageVersion</a></h1>
            @using (Html.BeginForm())
            {
                @Html.AntiForgeryToken()
                @Html.SpamPreventionFields()

                <div id="form-field-reason" class="form-group @Html.HasErrorFor(m => m.Reason)">
                    @Html.ShowLabelFor(m => m.Reason)
                    <p>Please select the reason for contacting support about your package.</p>
                    @Html.ShowEnumDropDownListFor(m => m.Reason, Model.ReasonChoices, "<Choose a Reason>")
                    @Html.ShowValidationMessagesFor(m => m.Reason)
                </div>
                <div class="form-group @Html.HasErrorFor(m => m.Message)">
                    @Html.ShowLabelFor(m => m.Message)
                    <p>Please provide a detailed description of your problem.</p>
                    @Html.ShowTextAreaFor(m => m.Message, 10, 50)
                    @Html.ShowValidationMessagesFor(m => m.Message)
                </div>
                <div class="form-group @Html.HasErrorFor(m => m.CopySender)">
                    @Html.ShowCheckboxFor(m => m.CopySender)
                    @Html.ShowLabelFor(m => m.CopySender)
                    @Html.ShowValidationMessagesFor(m => m.CopySender)
                </div>
                <input type="submit" value="Report" title="Report your problem with '@Model.PackageId'" />
            }
        </div>
    </div>
</div>

@section BottomScripts {
    @Html.SpamPreventionScript()
    <script>
        function reasonSelected() {
            var $form = $('#Reason').parents('form');
            var val = $('#Reason').val();
            if (val) {
                $form.validate().element($('#Reason'));
            }
        }

        $(function () {
            $('#Reason').change(reasonSelected);
            reasonSelected(); // Run once in case it starts with the bad selection
        });
    </script>
}